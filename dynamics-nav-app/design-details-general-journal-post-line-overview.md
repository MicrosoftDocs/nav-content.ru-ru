---
title: "Обзор строки учета финансового журнала"
description: "В этом разделе рассматриваются изменения модуля codeunit 12 **Фин. журнал строка учета** — это основной объект приложения для учета главной книги и единственное место для вставки операций главной книги, НДС, книги поставщиков и клиентов."
documentationcenter: 
author: SorenGP
ms.prod: dynamics-nav-2018
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: design, general ledger, post
ms.date: 07/01/2017
ms.author: sgroespe
ms.translationtype: HT
ms.sourcegitcommit: 1dfba8b14019991c95f40ffd5f7fbaed5df414eb
ms.openlocfilehash: b7280db4930ae707baa842d9d29871cafcb793bc
ms.contentlocale: ru-ru
ms.lasthandoff: 12/01/2017

---
# <a name="general-journal-post-line-overview"></a><span data-ttu-id="ababf-103">Обзор строки учета финансового журнала</span><span class="sxs-lookup"><span data-stu-id="ababf-103">General Journal Post Line Overview</span></span>
<span data-ttu-id="ababf-104">Модуль codeunit 12 **Фин. журнал - строка учета** — это основной объект приложения для учета главной книги и единственное место для вставки операций главной книги, НДС, книги поставщиков и клиентов.</span><span class="sxs-lookup"><span data-stu-id="ababf-104">Codeunit 12, **Gen. Jnl.-Post Line**, is the major application object for general ledger posting and is the only place to insert general ledger, VAT, and customer and vendor ledger entries.</span></span> <span data-ttu-id="ababf-105">Этот модуль codeunit также используется для всех операций применения, отмены применения и сторнирования.</span><span class="sxs-lookup"><span data-stu-id="ababf-105">This codeunit is also used for all Apply, Unapply and Reverse operations.</span></span>  
  
<span data-ttu-id="ababf-106">Хотя модуль codeunit улучшался в каждом выпуске за последние десять лет, его архитектура оставалась по большей части неизменной.</span><span class="sxs-lookup"><span data-stu-id="ababf-106">While the codeunit has been improved in each release over the last ten years, its architecture remained essentially unchanged.</span></span> <span data-ttu-id="ababf-107">Модуль codeunit стал очень большим и содержит приблизительно 7600 строк кода.</span><span class="sxs-lookup"><span data-stu-id="ababf-107">The codeunit became very large, with approximately 7,600 code lines.</span></span> <span data-ttu-id="ababf-108">В этом выпуске [!INCLUDE[d365fin](includes/d365fin_md.md)] архитектура изменена и модуль codeunit стало проще использовать и поддерживать.</span><span class="sxs-lookup"><span data-stu-id="ababf-108">With this release of [!INCLUDE[d365fin](includes/d365fin_md.md)], the architecture is changed and the codeunit has been made simpler and more maintainable.</span></span> <span data-ttu-id="ababf-109">Эта документация включает изменения и содержит сведения, необходимые для обновления.</span><span class="sxs-lookup"><span data-stu-id="ababf-109">This documentation introduces the changes and provides information that you will need for upgrade.</span></span>  
  
## <a name="old-architecture"></a><span data-ttu-id="ababf-110">Старая архитектура</span><span class="sxs-lookup"><span data-stu-id="ababf-110">Old Architecture</span></span>  
<span data-ttu-id="ababf-111">Старая архитектура имела следующие функции:</span><span class="sxs-lookup"><span data-stu-id="ababf-111">The old architecture had the following features:</span></span>  
  
* <span data-ttu-id="ababf-112">Глобальные переменные использовались слишком часто, что увеличивало возможность скрытых ошибок из-за неправильного использования переменных.</span><span class="sxs-lookup"><span data-stu-id="ababf-112">There was extensive use of global variables, which increased the possibility of hidden errors due to use of variables with the wrong scope.</span></span>  
* <span data-ttu-id="ababf-113">Существовало множество длинных процедур (содержащих более 100 строк кода) с высоким уровнем цикломатической сложности (т.е. частое использование вложенных операторов CASE, REPEAT и IF), из-за чего код было сложно считывать и поддерживать.</span><span class="sxs-lookup"><span data-stu-id="ababf-113">There were many long procedures (with more than 100 code lines) that also had high cyclomatic complexity (that is, a lot of CASE, REPEAT, IF nested statements), which made the code very difficult to read and maintain.</span></span>  
* <span data-ttu-id="ababf-114">Несколько процедур, которые использовались только локально и предназначались только для локального использования, не были отмечены как локальные.</span><span class="sxs-lookup"><span data-stu-id="ababf-114">Several procedures that were only used locally and were only meant to be used locally were not marked as local.</span></span>  
* <span data-ttu-id="ababf-115">В большинстве процедур отсутствовали параметры и использовались глобальные переменные.</span><span class="sxs-lookup"><span data-stu-id="ababf-115">Most procedures had no parameters and used global variables.</span></span> <span data-ttu-id="ababf-116">В некоторых процедурах использовались параметры и были переопределены глобальные переменные локальными значениями.</span><span class="sxs-lookup"><span data-stu-id="ababf-116">Some used parameters and overrode global variables with locals.</span></span>  
* <span data-ttu-id="ababf-117">Шаблоны кода для поиска счетов главной книги и создания операций НДС и главной книги не были стандартизированы и различаются в зависимости от места использования.</span><span class="sxs-lookup"><span data-stu-id="ababf-117">Code patterns for searching the general ledger accounts and creating general ledger and VAT entries was not standardized and varied from place to place.</span></span> <span data-ttu-id="ababf-118">Кроме того, часто возникает дублирование кода и нарушается симметрия между кодом клиента и поставщика.</span><span class="sxs-lookup"><span data-stu-id="ababf-118">In addition, there was a lot of code duplication and broken symmetry between customer and vendor code.</span></span>  
* <span data-ttu-id="ababf-119">Большая часть кода в модуле codeunit 12, т.е. приблизительно 30 процентов, связана с расчетами скидки оплаты и отклонения в оплате, хотя эти функции не требуются в большинстве стран или регионов.</span><span class="sxs-lookup"><span data-stu-id="ababf-119">A large part of the code in codeunit 12, approximately 30 percent, related to payment discount and tolerance calculations, although these features are not needed in many countries or regions.</span></span>  
* <span data-ttu-id="ababf-120">Функции "Учет", "Применить", "Отменить применение", "Сторнировать", "Скидка оплаты", "Отклонение в оплате" и "Коррекция валютного курса" были объединены в модуль codeunit 12 с помощью длинного списка глобальных переменных.</span><span class="sxs-lookup"><span data-stu-id="ababf-120">Posting, Apply, Unapply, Reverse, Payment Discount and Tolerance, and Exchange Rate Adjustment were married together in codeunit 12 using a long list of global variables.</span></span>  
  
### <a name="new-architecture"></a><span data-ttu-id="ababf-121">Новая архитектура</span><span class="sxs-lookup"><span data-stu-id="ababf-121">New Architecture</span></span>  
<span data-ttu-id="ababf-122">В [!INCLUDE[d365fin](includes/d365fin_md.md)] модуль codeunit 12 усовершенствован следующим образом:</span><span class="sxs-lookup"><span data-stu-id="ababf-122">In [!INCLUDE[d365fin](includes/d365fin_md.md)], codeunit 12 has had the following improvements:</span></span>  
  
* <span data-ttu-id="ababf-123">Модуль codeunit 12 был реорганизован на более мелкие процедуры (все содержат менее 100 строк кода).</span><span class="sxs-lookup"><span data-stu-id="ababf-123">Codeunit 12 has been refactored into smaller procedures (all less than 100 code lines).</span></span>  
* <span data-ttu-id="ababf-124">Стандартизированные шаблоны для поиска счетов главной книги реализованы с помощью вспомогательных функций из таблицы "Учетная группа".</span><span class="sxs-lookup"><span data-stu-id="ababf-124">Standardized patterns for the search of general ledger accounts have been implemented by using helper functions from Posting Group tables.</span></span>  
* <span data-ttu-id="ababf-125">Платформа механизма учета была реализована для управления началом и окончанием транзакций и для изолирования создания в главной книге и операциях НДС, коллекции коррекции НДС и расчета дополнительных сумм валюты.</span><span class="sxs-lookup"><span data-stu-id="ababf-125">A Posting Engine Framework has been implemented to manage the start and finish of transactions and to isolate the creation to general ledger and VAT entries, the collection of VAT adjustment, and the calculation of additional currency amounts.</span></span>  
* <span data-ttu-id="ababf-126">Дублирование кода устранено.</span><span class="sxs-lookup"><span data-stu-id="ababf-126">Code duplication has been eliminated.</span></span>  
* <span data-ttu-id="ababf-127">Множество вспомогательных функций перемещены в соответствующие таблицы и книги клиентов и поставщиков.</span><span class="sxs-lookup"><span data-stu-id="ababf-127">Many helper functions have been transferred to corresponding customer and vendor ledger entry tables.</span></span>  
* <span data-ttu-id="ababf-128">Использование глобальных переменных сведено к минимуму, чтобы в каждой процедуре использовались параметры и инкапсулировалась собственная логика применения.</span><span class="sxs-lookup"><span data-stu-id="ababf-128">The use of global variables has been minimized, so that each procedure uses parameters and encapsulates its own application logic.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ababf-129">См. также</span><span class="sxs-lookup"><span data-stu-id="ababf-129">See Also</span></span>  
<span data-ttu-id="ababf-130">[Сведения о проектировании: структура интерфейса учета](design-details-posting-interface-structure.md) </span><span class="sxs-lookup"><span data-stu-id="ababf-130">[Design Details: Posting Interface Structure](design-details-posting-interface-structure.md) </span></span>  
[<span data-ttu-id="ababf-131">Сведения о проектировании: структура механизма учета</span><span class="sxs-lookup"><span data-stu-id="ababf-131">Design Details: Posting Engine Structure</span></span>](design-details-posting-engine-structure.md)

