---
title: "Планирование автоматического выполнения работ"
description: "Запланированные задания обрабатываются очередью работ. Эти работы выполняют отчеты и модули Codeunit. В настройках можно указать однократное или периодически повторяющееся выполнение работы."
author: edupont04
ms.prod: dynamics-nav-2018
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: 
ms.date: 09/01/2017
ms.author: edupont
ms.translationtype: HT
ms.sourcegitcommit: 1dfba8b14019991c95f40ffd5f7fbaed5df414eb
ms.openlocfilehash: 86d23ee8f658bb31fa1eceb438bbe78774185c73
ms.contentlocale: ru-ru
ms.lasthandoff: 12/01/2017

---
# <a name="use-job-queues-to-schedule-tasks"></a><span data-ttu-id="245be-105">Использование очередей работ для планирования задач</span><span class="sxs-lookup"><span data-stu-id="245be-105">Use Job Queues to Schedule Tasks</span></span>
<span data-ttu-id="245be-106">Очереди работ в [!INCLUDE[d365fin](includes/d365fin_md.md)] позволяют пользователям планировать и создавать определенные отчеты, а также запускать модули codeunit.</span><span class="sxs-lookup"><span data-stu-id="245be-106">Job queues in [!INCLUDE[d365fin](includes/d365fin_md.md)] enables users to schedule and run specific reports and codeunits.</span></span> <span data-ttu-id="245be-107">В настройках можно указать однократное или периодически повторяющееся выполнение работы.</span><span class="sxs-lookup"><span data-stu-id="245be-107">You can set jobs to run one time, or on a recurring basis.</span></span> <span data-ttu-id="245be-108">Например, можно еженедельно составлять отчет **Менеджер - статистика продаж** для отслеживания продаж по менеджеру каждую неделю или ежедневно запускать модуль Codeunit **Обработка очереди сообщений серв. обслуживания** для обеспечения своевременной отправки клиентам ожидающих сообщений электронной почты, касающихся их сервисных заказов.</span><span class="sxs-lookup"><span data-stu-id="245be-108">For example, you might want to run the **Salesperson - Sales Statistics** report weekly, to track sales by salesperson each week, or you might want to run the **Process Service E-mail Queue** codeunit daily, to make sure pending email messages to customers regarding their service orders are sent out in a timely manner.</span></span>  

## <a name="add-jobs-to-the-job-queue"></a><span data-ttu-id="245be-109">Добавление работ в очередь работ</span><span class="sxs-lookup"><span data-stu-id="245be-109">Add Jobs to the Job Queue</span></span>
<span data-ttu-id="245be-110">В окне **Операции очереди работ** перечисляются все существующие работы.</span><span class="sxs-lookup"><span data-stu-id="245be-110">The **Job Queue Entries** window lists all existing jobs.</span></span> <span data-ttu-id="245be-111">При добавлении новой записи очереди заданий, которую нужно запланировать, необходимо указать сведения о типе объекта, который должен запускаться, например отчет или кодовая единица,а также имя и код объекта, который необходимо запустить.</span><span class="sxs-lookup"><span data-stu-id="245be-111">If you add a new job queue entry that you want to schedule, you must specify information about the type of object you want to run, such as a report or codeunit, and the name and object ID of the object that you want to run.</span></span> <span data-ttu-id="245be-112">Можно также добавлять параметры для определения поведения операции очереди заданий.</span><span class="sxs-lookup"><span data-stu-id="245be-112">You can also add parameters to specify the behavior of the job queue entry.</span></span> <span data-ttu-id="245be-113">Например, можно добавить параметр, чтобы только отправить учтенные заказы на продажу.</span><span class="sxs-lookup"><span data-stu-id="245be-113">For example, you can add a parameter to only send posted sales orders.</span></span> <span data-ttu-id="245be-114">У вас должны быть права на запуск указанного отчета или модуля codeunit, в противном случае при выполнении очереди работ будет возвращена ошибка.</span><span class="sxs-lookup"><span data-stu-id="245be-114">You must have permission to run the particular report or codeunit, or an error will be returned when the job queue is run.</span></span>  

<span data-ttu-id="245be-115">При необходимости можно задать фильтр в поле **Фильтр категории очереди работ**.</span><span class="sxs-lookup"><span data-stu-id="245be-115">Optionally, you can set a filter in the **Job Queue Category Filter** field.</span></span> <span data-ttu-id="245be-116">Категории очереди работ могут использоваться для группирования работ в списке.</span><span class="sxs-lookup"><span data-stu-id="245be-116">Job queue categories can be used to group jobs in the list.</span></span>

[!INCLUDE[d365fin](includes/d365fin_md.md)]<span data-ttu-id="245be-117"> автоматически выполняет работы в соответствии с указанными расписаниями для каждой записи очереди работ.</span><span class="sxs-lookup"><span data-stu-id="245be-117"> automatically runs the jobs according to the specified schedules for each job queue entry.</span></span> <span data-ttu-id="245be-118">Можно также вручную запустить, остановить и приостановить выполнение записи очереди работ.</span><span class="sxs-lookup"><span data-stu-id="245be-118">You can also start, stop, and put a job queue entry on hold manually.</span></span>

### <a name="log-files"></a><span data-ttu-id="245be-119">Файлы журнала</span><span class="sxs-lookup"><span data-stu-id="245be-119">Log Files</span></span>
<span data-ttu-id="245be-120">Ошибки отображаются в окне **Операции журнала очереди работ**, которое можно открыть с ленты.</span><span class="sxs-lookup"><span data-stu-id="245be-120">Errors are listed in the **Job Queue Log Entries** window that you can access from the ribbon.</span></span> <span data-ttu-id="245be-121">Также можно устранить ошибки очереди работ.</span><span class="sxs-lookup"><span data-stu-id="245be-121">You can also troubleshoot job queue errors.</span></span> <span data-ttu-id="245be-122">Данные, создаваемые при выполнении очереди работ, сохраняются в базе данных.</span><span class="sxs-lookup"><span data-stu-id="245be-122">Data that is generated when a job queue is run is stored in the database.</span></span>  

### <a name="background-posting-with-job-queues"></a><span data-ttu-id="245be-123">Фоновый учет с очередями работ</span><span class="sxs-lookup"><span data-stu-id="245be-123">Background Posting with Job Queues</span></span>
<span data-ttu-id="245be-124">Очереди работ — эффективный инструмент для планирования запуска бизнес-процессов в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="245be-124">Job queues are an effective tool to schedule the running of business processes in the background.</span></span> <span data-ttu-id="245be-125">Например, может существовать экземпляр, в котором несколько пользователей пробуют одновременно разместить заказы на продажу, но только один заказ может обрабатываться одновременно.</span><span class="sxs-lookup"><span data-stu-id="245be-125">For example, there may be an instance in which multiple users are trying to post sales orders at the same time, but only one order can be processed at a time.</span></span> <span data-ttu-id="245be-126">Путем настройки процедуры фонового учета можно разместить учтенные данные в очереди для обработки в фоне.</span><span class="sxs-lookup"><span data-stu-id="245be-126">By setting up a background posting routine, you can place the postings in a queue for processing in the background.</span></span>  

 <span data-ttu-id="245be-127">Кроме того, можно планировать учет на часы, в которые это удобно для вашей организации.</span><span class="sxs-lookup"><span data-stu-id="245be-127">Alternatively, you may want to schedule postings for hours when it is convenient for your organization.</span></span> <span data-ttu-id="245be-128">Например, может иметь смысл для бизнеса выполнять некоторые процедуры после ввода большинства данных за день.</span><span class="sxs-lookup"><span data-stu-id="245be-128">For example, it may make sense in your business to run certain routines when most of the data entry for the day has concluded.</span></span> <span data-ttu-id="245be-129">Для этого настройте очередь работ для выполнения различных отчетов по пакетному учету, например **Пакет. учет заказов продажи**, **Пакет. учет счетов продажи** и **Пакет. учет кредит-нот продажи**.</span><span class="sxs-lookup"><span data-stu-id="245be-129">You can achieve this by setting the job queue up to run various batch post reports, such as the **Batch Post Sales Orders**, **Batch Post Sales Invoices**, and **Batch Post Sales Credit Memos** reports.</span></span>  

 [!INCLUDE[d365fin](includes/d365fin_md.md)]<span data-ttu-id="245be-130"> поддерживает фоновый учет для следующих типов документов:</span><span class="sxs-lookup"><span data-stu-id="245be-130"> supports background posting for the following document types:</span></span>  

-   <span data-ttu-id="245be-131">Продажи: заказ на продажу, документ возврата, кредит-нота, счет</span><span class="sxs-lookup"><span data-stu-id="245be-131">Sales: sales order, return order, credit memo, invoice</span></span>  

-   <span data-ttu-id="245be-132">Покупки: заказ на покупку, возврат продажи, кредит-нота, инвойс</span><span class="sxs-lookup"><span data-stu-id="245be-132">Purchases: purchase order, return order, credit memo, invoice</span></span>  

 <span data-ttu-id="245be-133">Если очередь заданий не может выполнить учет заказа на продажу, статус меняется на **Ошибка**, и заказ на продажу добавляется в список заказов на продажу для обработки пользователем.</span><span class="sxs-lookup"><span data-stu-id="245be-133">If the job queue cannot post the sales order, the status is changed to **Error**, and the sales order is added to the list of sales orders that the user will have to handle.</span></span>  

> [!NOTE]  
>  <span data-ttu-id="245be-134">При планировании документа для учета и при начале процесс учета процедура учета автоматически настраивается на тайм-аут через 2 часа после того, как процедура учета перестанет отвечает по какой-либо причине.</span><span class="sxs-lookup"><span data-stu-id="245be-134">When you schedule a document for posting and the posting process begins, the posting routine is automatically configured to time out within two hours if the posting routine stops responding for any reason.</span></span>  

<span data-ttu-id="245be-135">Такое использование очереди работ настраивается в окне **Настройка модуля "Продажи"** или **Покупки и расчеты с кредиторами**, соответственно.</span><span class="sxs-lookup"><span data-stu-id="245be-135">You set up this use of the job queue in the **Sales & Receivables Setup** window or the **Purchases & Payables** window, respectively.</span></span> <span data-ttu-id="245be-136">На экспресс-вкладке **Фоновый учет** установите флажок **Учет документов в очереди работ**, затем заполните необходимые сведения.</span><span class="sxs-lookup"><span data-stu-id="245be-136">On the **Background Posting** FastTab, you choose the **Post Documents via Job Queue** check box and then fill in the relevant information.</span></span> <span data-ttu-id="245be-137">Здесь также можно использовать поле **Код категории очереди работ** для запуска всех записей очереди работ с таким кодом.</span><span class="sxs-lookup"><span data-stu-id="245be-137">Here you can also use the **Job Queue Category Code** field to run all job queue entries with that code.</span></span> <span data-ttu-id="245be-138">Например, можно использовать категорию **SalesPost**, которая выполняет фильтрацию всех заказов на продажу, которые соответствуют очереди работ с таким же кодом категории.</span><span class="sxs-lookup"><span data-stu-id="245be-138">For example, you can use  a **SalesPost** category that filters to all sales orders that match any job queue that has the same category code.</span></span>  

> [!IMPORTANT]  
>  <span data-ttu-id="245be-139">Если настроена работа, которая будет учитывать и печатать документы, и при отправке документа на печать принтер открывает диалоговое окно, например запрос для учетных данных или предупреждение о низком уровне чернил, то данный документ учитывается, но не печатается.</span><span class="sxs-lookup"><span data-stu-id="245be-139">If you set up a job that will post and print documents, and the printer displays a dialog box, such as a request for credentials or a warning about low printer ink, your document is posted but not printed.</span></span> <span data-ttu-id="245be-140">Соответствующая операция очереди работ в конечном итоге истекает, и в поле **Статус** задается **Ошибка**.</span><span class="sxs-lookup"><span data-stu-id="245be-140">The corresponding job queue entry eventually times out and the **Status** field is set to **Error**.</span></span> <span data-ttu-id="245be-141">Соответственно, рекомендуется не использовать настройку принтера, требующую взаимодействия с отображаемыми диалоговыми окнами печати в сочетании с фоновым учетом.</span><span class="sxs-lookup"><span data-stu-id="245be-141">Accordingly, we recommend that you do not use a printer setup that requires interaction with the display of printer dialog boxes in conjunction with background posting.</span></span>  

## <a name="use-the-my-job-queue-part"></a><span data-ttu-id="245be-142">Использование части "Моя очередь работ"</span><span class="sxs-lookup"><span data-stu-id="245be-142">Use the My Job Queue Part</span></span>
<span data-ttu-id="245be-143">Часть **Моя очередь работ** показывает операции очереди заданий, которые пользователь запустил, но они еще не завершены.</span><span class="sxs-lookup"><span data-stu-id="245be-143">The **My Job Queue** part shows the job queues entries that a user has started, but which are not yet finished.</span></span> <span data-ttu-id="245be-144">По умолчанию часть не видна, поэтому ее следует добавить в ролевой центр.</span><span class="sxs-lookup"><span data-stu-id="245be-144">By default, the part is not visible, so you have to add it to your Role Center.</span></span> <span data-ttu-id="245be-145">Дополнительные сведения см. в разделе [Практическое руководство. Изменение ролевых центров](change-role.md).</span><span class="sxs-lookup"><span data-stu-id="245be-145">For more information, see [How to: Change Role Centers](change-role.md).</span></span>  

<span data-ttu-id="245be-146">В этой части можно просмотреть обрабатываемые или поставленные в очередь документы, для которых ваш код указан в поле **Код исполнителя**.</span><span class="sxs-lookup"><span data-stu-id="245be-146">In this part, you can see those documents that are being processed or that are queued for which your ID is specified in the **Assigned User ID** field.</span></span> <span data-ttu-id="245be-147">Эта часть помогает отслеживать все записи очереди заданий, включая относящиеся к фоновому учету.</span><span class="sxs-lookup"><span data-stu-id="245be-147">The part helps you keep track of all job queue entries, including those related to background posting.</span></span> <span data-ttu-id="245be-148">По этой части можно быстро понять, произошла ли ошибка при учете документа и есть ли ошибки в записи очереди заданий.</span><span class="sxs-lookup"><span data-stu-id="245be-148">The part can tell you at a glance whether there has been an error in the posting of a document or if there are errors in a job queue entry.</span></span> <span data-ttu-id="245be-149">Эта часть также позволяет отменить учет документа, если он не запущен.</span><span class="sxs-lookup"><span data-stu-id="245be-149">The part also lets you cancel a document posting if it is not running.</span></span>  

## <a name="security"></a><span data-ttu-id="245be-150">Безопасность</span><span class="sxs-lookup"><span data-stu-id="245be-150">Security</span></span>  
<span data-ttu-id="245be-151">Записи очередь работ запускаются на основе прав.</span><span class="sxs-lookup"><span data-stu-id="245be-151">Job queue entries run based on permissions.</span></span> <span data-ttu-id="245be-152">Эти права доступа должны разрешать выполнение данного отчета или модуля Codeunit.</span><span class="sxs-lookup"><span data-stu-id="245be-152">Those permissions must allow the execution of the report or codeunit.</span></span>  

<span data-ttu-id="245be-153">При активации очереди заданий вручную используются учетные данные пользователя.</span><span class="sxs-lookup"><span data-stu-id="245be-153">When a job queue is activated manually, it is run with the credentials of the user.</span></span> <span data-ttu-id="245be-154">При активации очереди работ в качестве запланированного задания она запускается с учетными данными экземпляра сервера.</span><span class="sxs-lookup"><span data-stu-id="245be-154">When a job queue is activated as a scheduled task, it is run with the credentials of the server instance.</span></span> <span data-ttu-id="245be-155">При выполнении задания используются учетные данные очереди заданий, в которой оно активируется.</span><span class="sxs-lookup"><span data-stu-id="245be-155">When a job is run, it is run with the credentials of the job queue that activates it.</span></span> <span data-ttu-id="245be-156">Пользователь, который создал эту операцию очереди заданий, также должен иметь права доступа.</span><span class="sxs-lookup"><span data-stu-id="245be-156">However, the user who created that job queue entry must also have permissions.</span></span> <span data-ttu-id="245be-157">Когда работа "выполняется во время сеанса пользователя" (например, в фоновом учете), используются учетные данные пользователя, создавшего эту работу.</span><span class="sxs-lookup"><span data-stu-id="245be-157">When a job is “run in user session” (such as during background posting), it is run with the credentials of the user who created that job.</span></span>  

> [!IMPORTANT]  
>  <span data-ttu-id="245be-158">Если используется набор прав доступа SUPER, который поставляется с [!INCLUDE[d365fin](includes/d365fin_md.md)], данный пользователь и другие пользователи имеют права на запуск всех объектов.</span><span class="sxs-lookup"><span data-stu-id="245be-158">If you use the SUPER permissions set that comes with [!INCLUDE[d365fin](includes/d365fin_md.md)], you and your users have permissions to run all objects.</span></span> <span data-ttu-id="245be-159">В этом случае доступ каждого пользователя ограничен только правами доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="245be-159">In this case, access for each user is only limited by permissions for data.</span></span>  

## <a name="using-job-queues-effectively"></a><span data-ttu-id="245be-160">Эффективное использование очереди работ</span><span class="sxs-lookup"><span data-stu-id="245be-160">Using Job Queues Effectively</span></span>  
<span data-ttu-id="245be-161">Запись операции очереди заданий имеет множество полей, которые предназначены для переноса параметров в модуль codeunit, который был указан для запуска с использованием очереди заданий.</span><span class="sxs-lookup"><span data-stu-id="245be-161">The job queue entry record has many fields whose purpose is to carry parameters into a codeunit that you have specified to be run with a job queue.</span></span> <span data-ttu-id="245be-162">Это также означает, что модули codeunit, которые необходимо выполнить с помощью очереди работ, должны быть заданы записью операции очереди заданий в качестве параметра в триггере **OnRun**.</span><span class="sxs-lookup"><span data-stu-id="245be-162">This also means that codeunits that are to be run via the job queue must be specified with the Job Queue Entry record as a parameter in the **OnRun** trigger.</span></span> <span data-ttu-id="245be-163">Это помогает обеспечить дополнительную безопасность, поскольку не позволяет пользователю выполнять случайные модули codeunit с помощью очереди работ.</span><span class="sxs-lookup"><span data-stu-id="245be-163">This helps provide an extra level of security, as this prevents users from running random codeunits via the job queue.</span></span> <span data-ttu-id="245be-164">Если пользователь должен пересылать параметры в отчет, единственный способ — отправить исполнение отчета в модуль, которое затем анализирует параметры ввода и вносит их в отчет перед его выполнением.</span><span class="sxs-lookup"><span data-stu-id="245be-164">If the user must pass parameters to a report, the only way to do this is by wrapping the report execution into a codeunit, which then parses the input parameters and enters them into the report before executing it.</span></span>  

## <a name="see-also"></a><span data-ttu-id="245be-165">См. также</span><span class="sxs-lookup"><span data-stu-id="245be-165">See Also</span></span>  
[<span data-ttu-id="245be-166">Настройка и администрирование в Dynamics NAV</span><span class="sxs-lookup"><span data-stu-id="245be-166">Setup and Administration in Dynamics NAV</span></span>](admin-setup-and-administration.md)  
[<span data-ttu-id="245be-167">Установка Dynamics NAV</span><span class="sxs-lookup"><span data-stu-id="245be-167">Setting Up Dynamics NAV</span></span>](setup.md)  

