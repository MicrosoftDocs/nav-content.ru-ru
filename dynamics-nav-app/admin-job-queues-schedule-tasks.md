---
title: "Планирование автоматического выполнения работ"
description: "Запланированные задания обрабатываются очередью работ. Эти работы выполняют отчеты и модули Codeunit. В настройках можно указать однократное или периодически повторяющееся выполнение работы."
author: edupont04
ms.prod: dynamics-nav-2018
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: 
ms.date: 09/01/2017
ms.author: edupont
ms.translationtype: HT
ms.sourcegitcommit: 4fefaef7380ac10836fcac404eea006f55d8556f
ms.openlocfilehash: d88b2157892a60fb74a5dcfcd83524895485689f
ms.contentlocale: ru-ru
ms.lasthandoff: 10/16/2017

---
# <a name="use-job-queues-to-schedule-tasks"></a>Использование очередей работ для планирования задач
Очереди работ в [!INCLUDE[d365fin](includes/d365fin_md.md)] позволяют пользователям планировать и создавать определенные отчеты, а также запускать модули codeunit. В настройках можно указать однократное или периодически повторяющееся выполнение работы. Например, можно еженедельно составлять отчет **Менеджер - статистика продаж** для отслеживания продаж по менеджеру каждую неделю или ежедневно запускать модуль Codeunit **Обработка очереди сообщений серв. обслуживания** для обеспечения своевременной отправки клиентам ожидающих сообщений электронной почты, касающихся их сервисных заказов.  

## <a name="add-jobs-to-the-job-queue"></a>Добавление работ в очередь работ
В окне **Операции очереди работ** перечисляются все существующие работы. При добавлении новой записи очереди заданий, которую нужно запланировать, необходимо указать сведения о типе объекта, который должен запускаться, например отчет или кодовая единица,а также имя и код объекта, который необходимо запустить. Можно также добавлять параметры для определения поведения операции очереди заданий. Например, можно добавить параметр, чтобы только отправить учтенные заказы на продажу. У вас должны быть права на запуск указанного отчета или модуля codeunit, в противном случае при выполнении очереди работ будет возвращена ошибка.  

При необходимости можно задать фильтр в поле **Фильтр категории очереди работ**. Категории очереди работ могут использоваться для группирования работ в списке.

[!INCLUDE[d365fin](includes/d365fin_md.md)] автоматически выполняет работы в соответствии с указанными расписаниями для каждой записи очереди работ. Можно также вручную запустить, остановить и приостановить выполнение записи очереди работ.

### <a name="log-files"></a>Файлы журнала
Ошибки отображаются в окне **Операции журнала очереди работ**, которое можно открыть с ленты. Также можно устранить ошибки очереди работ. Данные, создаваемые при выполнении очереди работ, сохраняются в базе данных.  

### <a name="background-posting-with-job-queues"></a>Фоновый учет с очередями работ
Очереди работ — эффективный инструмент для планирования запуска бизнес-процессов в фоновом режиме. Например, может существовать экземпляр, в котором несколько пользователей пробуют одновременно разместить заказы на продажу, но только один заказ может обрабатываться одновременно. Путем настройки процедуры фонового учета можно разместить учтенные данные в очереди для обработки в фоне.  

 Кроме того, можно планировать учет на часы, в которые это удобно для вашей организации. Например, может иметь смысл для бизнеса выполнять некоторые процедуры после ввода большинства данных за день. Для этого настройте очередь работ для выполнения различных отчетов по пакетному учету, например **Пакет. учет заказов продажи**, **Пакет. учет счетов продажи** и **Пакет. учет кредит-нот продажи**.  

 [!INCLUDE[d365fin](includes/d365fin_md.md)] поддерживает фоновый учет для следующих типов документов:  

-   Продажи: заказ на продажу, документ возврата, кредит-нота, счет  

-   Покупки: заказ на покупку, возврат продажи, кредит-нота, инвойс  

 Если очередь заданий не может выполнить учет заказа на продажу, статус меняется на **Ошибка**, и заказ на продажу добавляется в список заказов на продажу для обработки пользователем.  

> [!NOTE]  
>  При планировании документа для учета и при начале процесс учета процедура учета автоматически настраивается на тайм-аут через 2 часа после того, как процедура учета перестанет отвечает по какой-либо причине.  

Такое использование очереди работ настраивается в окне **Настройка модуля "Продажи"** или **Покупки и расчеты с кредиторами**, соответственно. На экспресс-вкладке **Фоновый учет** установите флажок **Учет документов в очереди работ**, затем заполните необходимые сведения. Здесь также можно использовать поле **Код категории очереди работ** для запуска всех записей очереди работ с таким кодом. Например, можно использовать категорию **SalesPost**, которая выполняет фильтрацию всех заказов на продажу, которые соответствуют очереди работ с таким же кодом категории.  

> [!IMPORTANT]  
>  Если настроена работа, которая будет учитывать и печатать документы, и при отправке документа на печать принтер открывает диалоговое окно, например запрос для учетных данных или предупреждение о низком уровне чернил, то данный документ учитывается, но не печатается. Соответствующая операция очереди работ в конечном итоге истекает, и в поле **Статус** задается **Ошибка**. Соответственно, рекомендуется не использовать настройку принтера, требующую взаимодействия с отображаемыми диалоговыми окнами печати в сочетании с фоновым учетом.  

## <a name="use-the-my-job-queue-part"></a>Использование части "Моя очередь работ"
Часть **Моя очередь работ** показывает операции очереди заданий, которые пользователь запустил, но они еще не завершены. По умолчанию часть не видна, поэтому ее следует добавить в ролевой центр. Дополнительные сведения см. в разделе [Практическое руководство. Изменение ролевых центров](change-role.md).  

В этой части можно просмотреть обрабатываемые или поставленные в очередь документы, для которых ваш код указан в поле **Код исполнителя**. Эта часть помогает отслеживать все записи очереди заданий, включая относящиеся к фоновому учету. По этой части можно быстро понять, произошла ли ошибка при учете документа и есть ли ошибки в записи очереди заданий. Эта часть также позволяет отменить учет документа, если он не запущен.  

## <a name="security"></a>Безопасность  
Записи очередь работ запускаются на основе прав. Эти права доступа должны разрешать выполнение данного отчета или модуля Codeunit.  

При активации очереди заданий вручную используются учетные данные пользователя. При активации очереди работ в качестве запланированного задания она запускается с учетными данными экземпляра сервера. При выполнении задания используются учетные данные очереди заданий, в которой оно активируется. Пользователь, который создал эту операцию очереди заданий, также должен иметь права доступа. Когда работа "выполняется во время сеанса пользователя" (например, в фоновом учете), используются учетные данные пользователя, создавшего эту работу.  

> [!IMPORTANT]  
>  Если используется набор прав доступа SUPER, который поставляется с [!INCLUDE[d365fin](includes/d365fin_md.md)], данный пользователь и другие пользователи имеют права на запуск всех объектов. В этом случае доступ каждого пользователя ограничен только правами доступа к данным.  

## <a name="using-job-queues-effectively"></a>Эффективное использование очереди работ  
Запись операции очереди заданий имеет множество полей, которые предназначены для переноса параметров в модуль codeunit, который был указан для запуска с использованием очереди заданий. Это также означает, что модули codeunit, которые необходимо выполнить с помощью очереди работ, должны быть заданы записью операции очереди заданий в качестве параметра в триггере **OnRun**. Это помогает обеспечить дополнительную безопасность, поскольку не позволяет пользователю выполнять случайные модули codeunit с помощью очереди работ. Если пользователь должен пересылать параметры в отчет, единственный способ — отправить исполнение отчета в модуль, которое затем анализирует параметры ввода и вносит их в отчет перед его выполнением.  

## <a name="see-also"></a>См. также  
[Настройка и администрирование в Dynamics NAV](admin-setup-and-administration.md)  
[Установка Dynamics NAV](setup.md)  

